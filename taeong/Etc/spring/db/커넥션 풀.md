# 커넥션 풀


1. 우리 애플리케이션에서 이정도 커넥션을 쓰겠는데..? 라고 생각하는 만큼을 커넥션 풀에 미리 확보해놓음
    - 얼마나 보관할 지는 서비스의 특징과 서버 스펙에 따라 다르지만 기본값은 보통 10개

2. 커넥션 풀에 확보해놨을 시점에는 이미 TCP/IP연결을 해놓은 상태이기 떄문에 sql쿼리를 날리는 시점에서는 커넥션을 연결할 필요 없이 쿼리를 DB 에 즉시 전달할 수 있음
3. 애플리케이션 로직은 DB 드라이버를 통해서 커넥션을 요청하는 것이 **아님**! ⭐
4. **DB 드라이버를 통하지 않고 이미 생성되어있는 커넥션을 풀에 요청하면 됨**
5. 애플리케이션 로직이 커넥션을 다 사용하고 나면 그대로 종료하는 것이 아니라 **재사용할 수 있도록 커넥션 풀에 반환**하면 됨 **(커넥션이 살아있는 상태로!)**

### 정리

- 적절한 커넥션 풀 숫자는 서비스의 특징과 애플리케이션 서버 스펙, DB 서버 스펙에 따라 다르기 때문에 성능 테스트를 통해서 정해야 한다.
- 커넥션 풀은 **서버당 최대 커넥션 수를 제한**할 수 있다. 따라서 DB에 무한정 연결이 생성되는 것을 막아주어서 DB를 보호하는 효과도 있다.
- 대표적인 커넥션 풀 오픈소스는 commons-dbcp2 , tomcat-jdbc pool , `HikariCP` 등이 있다.
    - 성능과 사용의 편리함 측면에서 최근에는 hikariCP 를 주로 사용한다. **스프링 부트 2.0 부터는 기본 커넥션 풀로 hikariCP 를 제공**한다.
